---
name: taskmaster-workflow
description: Initialize task-master and parse PRDs from docs/prds/ into actionable tasks with optional subtask generation
---

# Taskmaster Skill

## Overview

Initialize task-master for a project and parse PRDs into actionable tasks with optional complexity analysis and subtask generation.

**Workflow:**
```
/prd → /taskmaster → tasks ready for implementation
```

**Announce at start:** "I'm using the taskmaster skill to initialize task-master and parse your PRD."

## Prerequisites

- PRD exists in `docs/prds/` (generated by `/prd` command)
- `task-master` CLI installed (`npm install -g task-master-ai`)

## Quick Reference

| Phase | Activity | Output |
|-------|----------|--------|
| 1. Project Check | Check/run `task-master init` | Initialized project |
| 2. Model Check | Check/run `task-master models --setup` | Configured AI models |
| 3. PRD Selection | List and select PRD from docs/prds/ | Selected PRD path |
| 4. Tag Decision | Create new or use existing tag | Active tag context |
| 5. Parse & Display | Parse PRD and show tasks | Task list |
| 6. Task Files | Optionally generate task files | Individual task files |
| 7. Subtask Analysis | Optionally analyze and expand tasks | Tasks with subtasks |

---

## Phase 1: Project Check

Check if task-master is initialized for this project.

**Step 1.1: Check for .taskmaster directory**

```bash
ls -d .taskmaster 2>/dev/null
```

**If exists:** Skip to Phase 2.

**If missing:** Run initialization.

**Step 1.2: Initialize task-master**

```bash
task-master init
```

Follow the interactive prompts to set project name and description.

**Error handling:**
- If `task-master` command not found: Stop and display:
  ```
  task-master CLI not found. Install with:
  npm install -g task-master-ai
  ```

---

## Phase 2: Model Check

Verify AI models are configured for task-master.

**Step 2.1: Check for config file**

```bash
ls .taskmaster/config.json 2>/dev/null
```

**If exists:** Skip to Phase 3.

**If missing:** Run model setup.

**Step 2.2: Configure models**

```bash
task-master models --setup
```

Follow interactive prompts to configure:
- Main model (for task generation)
- Research model (for analysis)
- Fallback model (optional)

**Note:** Requires API keys in `.env` file (ANTHROPIC_API_KEY, OPENAI_API_KEY, etc.)

---

## Phase 3: PRD Selection

List available PRDs and let user select one to parse, or use pre-provided path.

**Step 3.1: Check for pre-provided PRD path**

If `PRD_PATH` was provided in context (from prd-generator handoff):
- Display: "Using PRD: <PRD_PATH>"
- Skip to Phase 4

**Step 3.2: Find PRDs**

```bash
ls docs/prds/*.md 2>/dev/null
```

**If no PRDs found:** Stop and display:
```
No PRDs found in docs/prds/. Run /prd first to generate a PRD.
```

**Step 3.3: Present selection**

Use AskUserQuestion to present available PRDs:

```
Question: "Which PRD would you like to parse?"
Options: [List each PRD file found]
  - "2025-01-15-auth-prd.md" (Authentication feature)
  - "2025-01-20-dashboard-prd.md" (Dashboard redesign)
  - etc.
```

**Step 3.4: Store selection**

Store the selected PRD path for use in Phase 5.

---

## Phase 4: Tag Decision

Determine which tag context to use for the parsed tasks.

**Step 4.1: List existing tags**

```bash
task-master tags
```

**Step 4.2: Ask user for tag strategy**

Use AskUserQuestion:

```
Question: "How should tasks be organized?"
Options:
  - "Create new tag" (Creates tag from PRD name, isolates these tasks)
  - "Use existing tag: <tag-name>" (One option per existing tag)
  - "Use default tag" (No tag isolation, tasks go to default context)
```

**Step 4.3: Create or switch tag**

If creating new tag:
```bash
# Extract name from PRD filename (e.g., "auth" from "2025-01-15-auth-prd.md")
task-master add-tag <tag-name> -d="Tasks from <PRD filename>"
task-master use-tag <tag-name>
```

If using existing tag:
```bash
task-master use-tag <selected-tag>
```

If using default: No action needed.

---

## Phase 5: Parse & Display

Parse the selected PRD and display generated tasks.

**Step 5.1: Parse PRD**

```bash
task-master parse-prd --input=<selected-prd-path>
```

**Error handling:**
- If parse fails: Display error and suggest checking PRD format
- Common issues: Missing sections, malformed markdown

**Step 5.2: Display task list**

```bash
task-master list
```

Shows all generated tasks with IDs, titles, and status.

**Output example:**
```
Tasks for tag: auth
ID  Title                          Status    Priority
1   Set up authentication module   pending   high
2   Implement login endpoint       pending   high
3   Add session management         pending   medium
...
```

---

## Phase 6: Task File Generation (Optional)

Optionally generate individual task files for detailed tracking.

**Step 6.1: Ask user**

Use AskUserQuestion:

```
Question: "Generate individual task files?"
Options:
  - "Yes" (Creates .taskmaster/tasks/task_XXX.txt for each task)
  - "No" (Skip, can generate later with `task-master generate`)
```

**Step 6.2: Generate files (if yes)**

```bash
task-master generate
```

Creates individual task files in `.taskmaster/tasks/` directory.
Each file contains detailed task information for reference during implementation.

---

## Phase 7: Subtask Analysis & Generation (Optional)

Analyze task complexity and optionally break down complex tasks into subtasks.

**Step 7.1: Ask user**

Use AskUserQuestion:

```
Question: "Perform subtask analysis and generation?"
Options:
  - "Yes" (Analyze complexity, research context, expand tasks)
  - "No" (Skip, can analyze later with `task-master analyze-complexity`)
```

**If no:** Skip to completion.

**Step 7.2: Analyze complexity**

```bash
task-master analyze-complexity --research
```

Generates complexity scores (1-10) for each task and flags tasks that would benefit from expansion.

**Step 7.3: Display complexity report**

```bash
task-master complexity-report
```

Shows:
- Complexity scores for each task
- Recommendations for which tasks to expand
- Estimated subtask counts

**Step 7.4: Research context (optional)**

Use AskUserQuestion:

```
Question: "Run research for better subtask context?"
Options:
  - "Yes" (Gathers project context for smarter expansion)
  - "No" (Skip research, expand with existing context)
```

If yes:
```bash
task-master research "<PRD title/summary>" --tree
```

Gathers project structure and context for better subtask generation.

**Step 7.5: Choose expansion strategy**

Use AskUserQuestion:

```
Question: "How should tasks be expanded into subtasks?"
Options:
  - "Expand all flagged tasks" (Automatic, expands all high-complexity tasks)
  - "Select specific tasks" (Choose which tasks to expand)
  - "Skip expansion" (Can expand manually later)
```

**If "Expand all flagged":**
```bash
task-master expand --all --research
```

**If "Select specific tasks":**
Present list of high-complexity tasks, let user select, then for each:
```bash
task-master expand --id=<task-id> --research
```

**If "Skip":** Proceed to completion.

**Step 7.6: Display final task list**

```bash
task-master list --with-subtasks
```

Shows complete task hierarchy with all subtasks.

---

## Completion

After all phases complete, display summary:

```
✅ Taskmaster Complete

PRD: docs/prds/<filename>.md
Tag: <tag-name>
Tasks: <count> tasks generated
Subtasks: <count> subtasks (if expanded)

Next steps:
→ Run `/tm-execute` to start implementing tasks
→ Run `/tm-next` to preview the first task
→ Run `task-master list --with-subtasks` to see full hierarchy
```

---

## Error Handling

| Scenario | Response |
|----------|----------|
| `task-master` not installed | Display: `npm install -g task-master-ai` |
| No PRDs in docs/prds/ | Display: Run `/prd` first |
| Init fails | Stop flow, show error output |
| Parse fails | Show error, suggest checking PRD format |
| Model setup fails | Show error, check API keys in .env |
| No tasks flagged for expansion | Skip expansion, show success |

---

## Key Principles

| Principle | Application |
|-----------|-------------|
| Progressive disclosure | Each phase asks before proceeding |
| Graceful degradation | Skip optional phases if user declines |
| Clear feedback | Show results after each major step |
| Error recovery | Provide actionable fixes for common issues |
